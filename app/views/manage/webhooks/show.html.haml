= render "layouts/manage/page_title", title: "Webhook #{@webhook.id}" do

  .btn-group
    = link_to "Edit", edit_manage_webhook_path(@webhook), class: 'btn btn-sm btn-outline-secondary'
    = link_to "Delete", manage_webhook_path(@webhook), method: :delete, data: { confirm: "Are you sure? This action is irreversible." }, class: 'btn btn-sm btn-outline-secondary'

.row.mt-2.mb-4
  .col-lg-6
    .card.mb-3
      .card-header= "Webhook Information"
      .card-body
        .row
          %dt.col-md-5= "On"
          %dd.col-md-7= Webhook::POSSIBLE_EVENTS[@webhook.event]
        .row
          %dt.col-md-5= "Format"
          %dd.col-md-7= @webhook.format
        .row
          %dt.col-md-5= "Sent To"
          %dd.col-md-7= @webhook.url
        .row
          %dt.col-md-5= "Secret"
          %dd.col-md-7= @webhook.secret? ? @webhook.secret : "&#8203;".html_safe
        .row
          %dt.col-md-5= "Enabled"
          %dd.col-md-7
            - if @webhook.active
              %span.badge.badge-success= "Yes"
            - else
              %span.badge.badge-danger= "No"
        .row
          %dt.col-md-5= "Created At"
          %dd.col-md-7= display_datetime(@webhook.created_at)

    .card.mb-3
      .card-header= "Test Webhook"
      .card-body.pb-2
        = link_to "Send Test", test_manage_webhook_path(@webhook), class: 'btn btn-sm btn-success'
        %br

        -if @status
          %br
          .row
            %dt.col-md-5= "Status Code"
            %dd.col-md-7
              - if @status[:code] < 300 && @status[:code] >= 200
                %span.badge.badge-success= @status[:code]
              - else
                %span.badge.badge-danger= @status[:code]
          .row
            %dt.col-md-5= "Body"
            %dd.col-md-7
              %pre= @status[:body]

  .col-lg-6
    .card.mb-3
      .card-header= "Change History"
      .card-body.pb-2
        = render "model_history", model: @webhook
